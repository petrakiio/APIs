<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vale Ler</title>
    <link rel="stylesheet" href="../static/style.css">
    <link rel="shortcut icon" href="../static/img/valeLer.png" type="image/x-icon">
</head>
<body>

<nav class="navbar">
    <div class="nav-brand">ðŸ“š Biblioteca Vale Ler</div>
        <ul class="nav-links">
        {% if session.get('usuario_id') %}
            {# LINKS PARA LOGADOS #}
            <li><a href="/perfil">Perfil</a></li>
            <li><a href="/devolver">Como Devolver?</a></li>

            {% if session.get('is_admin') %}
                {# LINKS EXCLUSIVOS ADMIN #}
                <li><a href="/add_livros">Adicionar</a></li>
                <li><a href="/emprestimo">Emprestar</a></li>
                <li><a href="/editar">Editar</a></li>
                <li><a href="/deletar">Remover</a></li>
                <li><a href="/admin/feedbacks">Feedbacks | Administrar </a></li>
            {% endif %}

            <li><a href="/emprestimo">Pedir livro</a></li>
            
            {# FEEDBACK PARA LOGADOS (NÃƒO ADMIN) #}
            {% if not session.get('is_admin') %}
                <li><a href="/feedback">Feedback</a></li>
            {% endif %}

            <li><a href="/logout" style="color: #ff6b6b;">Sair</a></li>

        {% else %}
            {# LINKS PARA DESLOGADOS #}
            <li><a href="/feedback">Feedback</a></li> {# VisÃ­vel para quem nÃ£o estÃ¡ logado #}
            <li><a href="/login">Login</a></li>
            <li><a href="/cadastro">Cadastro</a></li>
            <li><a href="/devolver">Como Devolver?</a></li>
        {% endif %}
    </ul>
    {% if session.get('usuario_id') %}
    <div class="nav-user">
        <span>{{ session.get('nome') }}</span>
        <img src="{{ session.get('img') }}" alt="Avatar" class="user-avatar">
    </div>
    {% endif %}
</nav>

<main>
    <h2>ðŸ“˜ Livros Cadastrados</h2>
    <div class="search-bar">
        <form id="search-form">
            <input id="search-input" type="text" name="q" placeholder="Pesquisar por tÃ­tulo ou autor..." />
            <button type="submit">Pesquisar</button>
        </form>
    </div>

    <div id="search-result" class="search-result"></div>

    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>TÃ­tulo</th>
                    <th>Autor</th>
                    <th>Editora</th>
                    <th>Ano</th>
                    <th>ISBN</th>
                    <th>Categoria</th>
                    <th>Total</th>
                    <th>DisponÃ­vel</th>
                </tr>
            </thead>
            <tbody>
                {% for livro in livros %}
                <tr>
                    <td>{{ livro.id_livro }}</td>
                    <td><strong>{{ livro.titulo }}</strong></td>
                    <td>{{ livro.autor }}</td>
                    <td>{{ livro.editora }}</td>
                    <td>{{ livro.ano_publicacao }}</td>
                    <td>{{ livro.isbn }}</td>
                    <td>{{ livro.categoria }}</td>
                    <td>{{ livro.total_unidades }}</td>
                    <td>{{ livro.unidades_disponiveis }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {% if session.get('is_admin') %}
    <h2>ðŸ“• GestÃ£o de EmprÃ©stimos (Admin)</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Livro</th>
                <th>Pessoa</th>
                <th>EmprÃ©stimo</th>
                <th>DevoluÃ§Ã£o</th>
                <th>Valor</th>
                <th>AÃ§Ã£o</th>
            </tr>
        </thead>
        <tbody>
            {% for emprestimo in emprestimos %}
            <tr>
                <td>{{ emprestimo.id_emprestimo }}</td>
                <td>{{ emprestimo.titulo }}</td>
                <td>{{ emprestimo.nome_pessoa }}</td>
                <td>{{ emprestimo.data_emprestimo }}</td>
                <td>{{ emprestimo.data_devolucao }}</td>
                <td>R$ {{ emprestimo.valor }}</td>
                <td>
                    <form method="POST" action="/devolver/{{ emprestimo.id_emprestimo }}">
                        <button type="submit" class="btn-devolver" onclick="return confirm('Confirmar devoluÃ§Ã£o?')">
                            Baixa
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <h2>ðŸ“• Meus Livros(pendentes)</h2>
    <table>
        <thead>
            <tr>
                <th>Livro</th>
                <th>EmprÃ©stimo</th>
                <th>DevoluÃ§Ã£o</th>
                <th>Valor</th>
            </tr>
        </thead>
        <tbody>
            {% for livro in livros_user %}
            <tr>
                <td>{{ livro.titulo }}</td>
                <td>{{ livro.data_emprestimo }}</td>
                <td>{{ livro.data_devolucao }}</td>
                <td>R$ {{ livro.valor }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</main>

<footer class="site-footer">
    <p>&copy; 2026 Vale Ler. Todos os direitos reservados.</p>
    <div class="footer-links">
        <a class="social-link" href="" aria-label="GitHub" id="git">
            <svg class="social-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path fill="currentColor" d="M12 2C6.48 2 2 6.58 2 12.26c0 4.51 2.87 8.34 6.84 9.7.5.1.68-.22.68-.48 0-.24-.01-.86-.01-1.69-2.78.63-3.37-1.2-3.37-1.2-.45-1.2-1.11-1.52-1.11-1.52-.91-.64.07-.63.07-.63 1 .07 1.53 1.06 1.53 1.06.9 1.58 2.36 1.13 2.94.86.09-.66.35-1.13.63-1.39-2.22-.26-4.56-1.16-4.56-5.15 0-1.14.39-2.07 1.03-2.8-.1-.26-.45-1.31.1-2.74 0 0 .84-.28 2.75 1.07a9.19 9.19 0 0 1 5 0c1.9-1.35 2.74-1.07 2.74-1.07.55 1.43.2 2.48.1 2.74.64.73 1.03 1.66 1.03 2.8 0 4-2.34 4.88-4.58 5.13.36.32.68.94.68 1.9 0 1.37-.01 2.47-.01 2.81 0 .26.18.59.69.48 3.97-1.36 6.83-5.2 6.83-9.7C22 6.58 17.52 2 12 2z"/>
            </svg>
            GitHub
        </a>
        <a class="social-link" href="" aria-label="LinkedIn" id="linkedin">
            <svg class="social-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path fill="currentColor" d="M4.98 3.5c0 1.38-1.11 2.5-2.48 2.5C1.12 6 0 4.88 0 3.5 0 2.12 1.12 1 2.5 1c1.37 0 2.48 1.12 2.48 2.5zM.5 23.5h4V7.98h-4V23.5zM8.5 7.98h3.83v2.12h.05c.53-1 1.82-2.06 3.74-2.06 4 0 4.74 2.66 4.74 6.11v7.35h-4v-6.52c0-1.56-.03-3.56-2.17-3.56-2.17 0-2.5 1.7-2.5 3.45v6.63h-4V7.98z"/>
            </svg>
            LinkedIn
        </a>
    </div>
</footer>

</body>
<script src="../static/script/index.js"></script>
</html>
